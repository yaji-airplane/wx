<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>天気図表示</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
        }
        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 0px;
        }
        button {
            margin: 3px;
            padding: 5px 10px;
            font-size: 16px;
        }
        img {
            max-width: 95%;
            height: auto;
            margin-top: 5px;
        }
        #debug {
            margin-top: 5px;
            font-size: 14px;
        }
    </style>
    <script>
        function getUTCDateFromLocal() {
            const now = new Date();
            const utcYear = now.getUTCFullYear();
            const utcMonth = ('0' + (now.getUTCMonth() + 1)).slice(-2); // 月を2桁にフォーマット
            const utcDay = ('0' + now.getUTCDate()).slice(-2); // 日を2桁にフォーマット
            const utcHours = now.getUTCHours();
            const utcMinutes = now.getUTCMinutes();
            return {
                date: new Date(Date.UTC(utcYear, utcMonth - 1, utcDay, utcHours, utcMinutes)),
                formatted: `${utcYear}${utcMonth}${utcDay}`,
                prevFormatted: getPreviousFormattedDate(utcYear, utcMonth, utcDay) // この行を追加
            };
        }

        function getPreviousFormattedDate(year, month, day) {
            const date = new Date(Date.UTC(year, month - 1, day));
            date.setUTCDate(date.getUTCDate() - 1);
            const prevYear = date.getUTCFullYear();
            const prevMonth = ('0' + (date.getUTCMonth() + 1)).slice(-2);
            const prevDay = ('0' + date.getUTCDate()).slice(-2);
            return `${prevYear}${prevMonth}${prevDay}`;
        }

        function getURL(type, utc) {
            const utcHours = utc.date.getUTCHours();
            const utcMinutes = utc.date.getUTCMinutes();
            const base = `https://www3.metair.go.jp/pict/${type}/`;
            let url = '';

            switch(type) {
                case 'ASAS':
                    if (utcHours > 20 || (utcHours === 20 && utcMinutes >= 35)) url = `${base}QACA98_RJTD_${utc.formatted}180000.png`;
                    else if (utcHours > 14 || (utcHours === 14 && utcMinutes >= 35)) url = `${base}QACA98_RJTD_${utc.formatted}120000.png`;
                    else if (utcHours > 8 || (utcHours === 8 && utcMinutes >= 35)) url = `${base}QACA98_RJTD_${utc.formatted}060000.png`;
                    else if (utcHours > 2 || (utcHours === 2 && utcMinutes >= 35)) url = `${base}QACA98_RJTD_${utc.formatted}000000.png`;
                    else url = `${base}QACA98_RJTD_${utc.prevFormatted}180000.png`; // この行を調整
                    break;
                // 他のケースも同様に "前日" のロジックを処理するように調整...
            }
            return url;
        }

        function showImage(type) {
            const utc = getUTCDateFromLocal();
            const url = getURL(type, utc);
            document.getElementById('weather-image').src = url;
            document.getElementById('debug').innerText = `UTC: ${utc.date.toISOString()}\nURL: ${url}`;
        }
    </script>
</head>
<body>
    <h1></h1>
    <div class="button-container">
        <button onclick="showImage('ASAS')">ASAS</button>
        <button onclick="showImage('FSAS24')">FSAS24</button>
    <br>
        <button onclick="showImage('AUPQ78')">AUPQ78</button>
        <button onclick="showImage('AUPQ35')">AUPQ35</button>
        <button onclick="showImage('AUPA25')">AUPA25</button>
        <button onclick="showImage('AUPA20')">AUPA20</button>
        <button onclick="showImage('FUPA502')">FUPA502</button>
        <button onclick="showImage('FUPA302')">FUPA302</button>
        <button onclick="showImage('FUPA252')">FUPA252</button>
    <br>
        <button onclick="showImage('AXJP140')">AXJP140</button>
        <button onclick="showImage('FXJP106')">FXJP106</button>
        <button onclick="showImage('ABJP')">ABJP</button>
        <button onclick="showImage('FBJP')">FBJP</button>
        <button onclick="showImage('FBAE')">FBAE</button>
    </div>
    <img id="weather-image" alt="天気図がここに表示されます">
    <div id="debug"></div>
</body>
</html>
